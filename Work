--Show Customers (their full names, customer ID, and country) who are not in the US.
SELECT FirstName, LastName, CustomerID, Country
FROM customers
WHERE Country <> 'USA';

--Show only the Customers from Brazil.
SELECT * FROM customers
WHERE Country = 'Brazil';

--Find the Invoices of customers who are from Brazil. The resulting table should show the customer's full name, Invoice ID, Date of the invoice, and billing country.
SELECT i.InvoiceID, c.FirstName, c.LastName, i.InvoiceDate, i.BillingCountry
FROM customers AS c
JOIN invoices AS i
ON c.CustomerId = i.CustomerId
WHERE c.Country = 'Brazil';

--Show the Employees who are Sales Support Agents.
SELECT * FROM employees
WHERE title = 'Sales Support Agent';

--Show a list of Employees who were hired after this date.

--Find a unique list of billing countries from the Invoice table.
SELECT DISTINCT BillingCountry 
FROM invoices;

--Show the number of invoices associated with each sales agent.
SELECT e.FirstName, e.LastName, COUNT(InvoiceID) AS Total_invoices
FROM employees AS e
INNER JOIN customers AS c
ON e.EmployeeID = c.SupportRepID
INNER JOIN invoices AS i
ON c.CustomerId = i.InvoiceID
GROUP BY e.FirstName;

--Show the Invoice Total, Customer name, Country, and Sales Agent name for all invoices and customers.
SELECT i.Total, c.FirstName, c.LastName, c.Country, e.FirstName, e.LastName
FROM customers AS c
FULL JOIN employees AS e
ON e.EmployeeID = c.SupportRepID
INNER JOIN invoices AS i
ON c.CustomerID = i.InvoiceID;

--How many Invoices were there in 2009?
SELECT COUNT(InvoiceID) AS Total_Invoices
FROM invoices
WHERE InvoiceDate LIKE '%2009%';

--What are the total sales for 2009?
SELECT SUM(quantity*UnitPrice) AS Total_Sales
FROM invoice_items
JOIN invoices
ON invoices.InvoiceID = invoice_items.InvoiceLineID
WHERE InvoiceDate LIKE '%2009%';


--Write a query that includes the purchased track name with each invoice line ID.
SELECT InvoiceLineID, Name AS Track_Name
FROM invoice_items
INNER JOIN tracks
ON tracks.TrackId = invoice_items.TrackId;

--Write a query that includes the purchased track name AND artist name with each invoice line ID.
SELECT ii.InvoiceLineID, t.Name, at.Name AS Track_Name
FROM invoice_items AS ii
INNER JOIN tracks AS t
ON t.TrackId = ii.TrackId
INNER JOIN albums AS al
ON al.AlbumId = t.AlbumId
INNER artists AS at
ON at.ArtistID = al.ArtistID;


--Provide a query that shows all the Tracks, and include the Album name, Media type, and Genre.
--Show the total sales made by each sales agent.
--Which sales agent made the most dollars in sales in 2009?
